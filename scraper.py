import requests
from bs4 import BeautifulSoup
import json
import time


BASE_URL = "https://docs.capillarytech.com/docs/"

INSIGHTS_PAGES = [
    "insights_overview",
    "insights-product-navigation",
    "terms-and-abbreviations",
    "kpi-and-dimensions",
    "list-of-kpis-and-dimesions",
    "create-normal-migration-charts",
    "create-chart",
    "view-chart-details",
    "edit-or-modify-chart",
    "delete-chart",
    "advanced-filter",
    "overview-1",
    "reporting-standard-report",
    "reporting-custom-report",
    "custom-reports-overview",
    "create",
    "edit-or-delete",
    "share-report",
    "insights-archive-report",
    "managing-reports",
    "view-or-access-report",
    "add-audience-group",
    "download-report",
    "explore-charts-in-reports-explore-mode",
    "apply-dimensions-to-charts",
    "target-setting",
    "insights-schedule-report",
    "share-report-url",
    "date-range-filter-comparison-with-previous-period-1",
    "apply-filters-in-report-1",
    "audience-group-filter-in-reports",
    "fact-dimension-tables",
    "dimension-tables",
    "1-points-awardeddeducted-scenarios",
    "return-after-redemption-scenarios",
    "customer-segmentation",
    "create-segments-through-file-upload",
    "create-segments-using-scheduled-ftp-upload",
    "create-segments-using-filters",
    "export",
    "data-export-faqs",
    "return-transactions-standard-export-template",
    "response-info-standard-export-template",
    "contacted-standard-export-template",
    "transactions-standard-export-template",
    "payment-mode-standard-export-template",
    "tracker-value-standard-export-template",
    "customer-merge-event-log-standard-export-template",
    "slab-change-log-standard-export-template",
    "issue-trackers-standard-export-template",
    "messages-standard-export-template",
    "call-tasks-standard-export-template",
    "footfall-standard-export-template",
    "profiles-2-standard-export-template",
    "points-standard-export-template",
    "members-standard-export-template",
    "coupons-standard-export-template",
    "badges-standard-export-template",
    "registration-event-standard-export-template",
    "goodwill-requests-standard-export-template",
    "invitation-sent-standard-export-template",
    "dimensions-attributes",
    "custom-templates",
    "configure-ftp-server-for-data-export",
    "schedule-an-export-job-fetch-details",
    "create-an-export-job-step-1-of-3",
    "select-data-templates-step-2-of-3",
    "modifying-template-creating-schedule-step-3-of-3",
    "editing-an-export-job",
    "reuse-an-export-job-duplicate",
    "exporting-audience-group",
    "use-cases-on-data-export",
    "fraud-detection-rules",
    "methodology",
    "use-case-for-score-calculation",
    "faqs-10",
    "bi-tool-connector",
    "steps-to-connect-to-bi-tool-powerbi-tableau",
    "bi-tool-connector-faq",
    "configure-custom-namespace-for-organisation",
    "getting-started-databricks",
    "mask-data-in-databricks",
    "automated-notebook-execution-based-on-etl-completion",
    "data-encryption-settings",
]

INSIGHTS_PAGES = [
    "insights_overview",
    "insights-product-navigation",
    "terms-and-abbreviations",
    "kpi-and-dimensions",
    "list-of-kpis-and-dimesions",
    "create-normal-migration-charts",
    "create-chart",
    "view-chart-details",
    "edit-or-modify-chart",
    "delete-chart",
    "advanced-filter",
    "overview-1",
    "reporting-standard-report",
    "reporting-custom-report",
    "custom-reports-overview",
    "create",
    "edit-or-delete",
    "share-report",
    "insights-archive-report",
    "managing-reports",
    "view-or-access-report",
    "add-audience-group",
    "download-report",
    "explore-charts-in-reports-explore-mode",
    "apply-dimensions-to-charts",
    "target-setting",
    "insights-schedule-report",
    "share-report-url",
    "date-range-filter-comparison-with-previous-period-1",
    "apply-filters-in-report-1",
    "audience-group-filter-in-reports",
    "fact-dimension-tables",
    "dimension-tables",
    "1-points-awardeddeducted-scenarios",
    "return-after-redemption-scenarios",
    "customer-segmentation",
    "create-segments-through-file-upload",
    "create-segments-using-scheduled-ftp-upload",
    "create-segments-using-filters",
    "export",
    "data-export-faqs",
    "return-transactions-standard-export-template",
    "response-info-standard-export-template",
    "contacted-standard-export-template",
    "transactions-standard-export-template",
    "payment-mode-standard-export-template",
    "tracker-value-standard-export-template",
    "customer-merge-event-log-standard-export-template",
    "slab-change-log-standard-export-template",
    "issue-trackers-standard-export-template",
    "messages-standard-export-template",
    "call-tasks-standard-export-template",
    "footfall-standard-export-template",
    "profiles-2-standard-export-template",
    "points-standard-export-template",
    "members-standard-export-template",
    "coupons-standard-export-template",
    "badges-standard-export-template",
    "registration-event-standard-export-template",
    "goodwill-requests-standard-export-template",
    "invitation-sent-standard-export-template",
    "dimensions-attributes",
    "custom-templates",
    "configure-ftp-server-for-data-export",
    "schedule-an-export-job-fetch-details",
    "create-an-export-job-step-1-of-3",
    "select-data-templates-step-2-of-3",
    "modifying-template-creating-schedule-step-3-of-3",
    "editing-an-export-job",
    "reuse-an-export-job-duplicate",
    "exporting-audience-group",
    "use-cases-on-data-export",
    "fraud-detection-rules",
    "methodology",
    "use-case-for-score-calculation",
    "faqs-10",
    "bi-tool-connector",
    "steps-to-connect-to-bi-tool-powerbi-tableau",
    "bi-tool-connector-faq",
    "configure-custom-namespace-for-organisation",
    "getting-started-databricks",
    "mask-data-in-databricks",
    "automated-notebook-execution-based-on-etl-completion",
    "data-encryption-settings",
]

CDP_PAGES = [
    "data-entities",
    "customer_entity",
    "store-hierarchy",
    "set-transactions",
    "handling-of-rejected-transactions",
    "setup-test-behavioral-events",
    "card",
    "user-group",
    "hierarchy",
    "data-fields",
    "use-case-search-filter",
    "overview-search-filter",
    "create-search-filter-",
    "performing-search-",
    "search-filter-faq",
    "member-care",
    "register-customers",
    "search-customercoupon",
    "issue-update-cards",
    "manage-change-request",
    "issue-goodwill-points-coupons",
    "tag-not-interested-transactions",
    "reallocate-mobile-numbers",
    "manage-customer-feedback-1",
    "customer_overview",
    "view-loyalty_details",
    "view-event_details",
    "view-incentive_details",
    "view-communication_details",
    "manage-id-change_requests",
    "issue-goodwill-points_coupons",
    "retro_transaction",
    "session_logs",
    "group_view",
    "advanced-points-breakup_view",
    "connectplus_overview",
    "connectplus_getting_started",
    "know-about-expressions-in-connect",
    "configure-blocks-connectplus",
    "connect-to-source",
    "decrypt-data",
    "connect-to-destination",
    "transform-data",
    "join-data",
    "csv-to-xml-converter",
    "push-to-s3",
    "encrypt-data",
    "schedule-trigger",
    "rebuild-headers-define-headers-and-transform-data",
    "mask-contents-in-a-csv",
    "invoke-neo-iteratively",
    "convert-json-to-csvavro-format",
    "convert-csv-to-json",
    "event-notification-block-",
    "test_and_control",
    "add_transaction",
    "file-transfer-templates",
    "data_reconciliation_template",
    "transaction-line-item-merge",
    "pii_cleanup_template",
    "customer_v2_add",
    "create_badges",
    "import-earned-badges-of-customer-template",
    "csv_to_xml_conversion",
    "coupon-redeem",
    "workspace-user-management",
    "audience-reload-from-ftp",
    "onboard-users-to-intouch",
    "card-update-template",
    "ftp-to-s3",
    "behavioural-events-ingestion",
    "goodwill-points-issue-template",
    "earned-badges-for-customer-template",
    "retro-transaction-template",
    "create-rewards_connectplus-template",
    "update-reward-connectplus",
    "force-generate-barcode-template",
    "connectplus-databricks-job-trigger-template",
    "sftp-to-sftp-with-headers-definition",
    "pull-data-from-api",
    "analyse-dataflow-performance",
    "troubleshooting-guide-connectplus",
    "diy-templates-connectplus",
    "transactions-profiles",
    "customer-profiles",
    "inventory-profiles",
    "org-entities",
    "points-slabs",
    "points-deductions",
    "points-expiry",
    "other-import-profiles",
    "data-cleanup",
    "target-loyalty-1",
    "company",
    "view-import-jobs-1",
    "fetching-import-details-by-import-id",
    "configure_event_notification",
    "add-event-notification-account",
    "editdelete-event-notification",
    "consuming-event-notifications",
    "event-schema-payload",
    "fraud-detection",
    "new-request-workflow",
    "new-request-flow-introduction",
    "configuring-issue-badges-request-workflow",
    "configuring-earn-badge-request-workflow",
    "configuring-customer-status-change-request-workflow",
    "configuring-points-redemption-request-workflow",
    "configuring-goodwill-points-request-workflow",
    "new-request-workflow-faq",
]

API_PAGES = [
    "apioverview",
    "api-index",
    "authentication",
    "oauth",
    "basic-authentication",
    "auth-for-consumer-or-end-customer-apps",
    "authorisation",
    "rate-limits",
    "errors-and-warnings",
    "timezone-management",
    "make-your-first-api-call",
    "customer",
    "recommendations",
    "get-user-recommendations",
    "get-cart-recommendations",
    "change_identifier-on-auth-engine",
    "add-customer",
    "update-customer-details_v1api",
    "update-customer-identifiers-1",
    "search-customers",
    "get-customer-details-v1api",
    "get-customer-transactions",
    "get-customer-redemptions",
    "addupdate-customer-notes",
    "get-customer-notes",
    "get-customer-interactions",
    "add-ticket",
    "get-ticket-details",
    "get-referral-details",
    "addupdate-customer-preferences",
    "get-customer-preferences",
    "update-subscription-details-1",
    "get-subscription-details-1",
    "v2-add-customer",
    "get-customer-id",
    "update-identifiersissue-card",
    "customer-upsert-api",
    "associate-customer",
    "get-customer-details-v2",
    "customer-hierarchy",
    "update-customer-detail",
    "update-association-details",
    "search-customers-1",
    "update-subscription-details",
    "get-subscription-details-1-1",
    "get_v2-customers-customerid-trackers",
    "get-points-expiry-schedule",
    "get-points-expiry-schedule-light-api",
    "get-loyalty-events",
    "get-loyalty-details-1",
    "get-points-transfer-summary",
    "get-points-balance",
    "get-customer-tier",
    "get-points-conversion-schedule",
    "get-customer-coupons-detailed",
    "get-retro-requests",
    "get-identifier-change-requests",
    "get-goodwill-requests",
    "get-goodwill-request-group",
    "add-customer-image",
    "delete-customer-image",
    "linkdelink-card",
    "get-status-log-1",
    "get-customer-subscription-log",
    "get-customer-image",
    "get-user-group-customer-tracker-details",
    "v2api-get-customer-transactions",
    "v2get-customer-interactions",
    "status-codes-customer",
    "update-customers-lookup",
    "get-customer-details",
    "update-customer-status",
    "get-subscription-details",
    "get-customer-loyalty-details",
    "get-retro-requests-1",
    "set-customer-image-1",
    "get-referrals-lookup",
    "get-customer-recommendations",
    "get_points_balance",
    "get-customer-tier-1",
    "get-points-conversion-schedule-1",
    "add-labels",
    "get-org-labels",
    "tag-customers-to-labels",
    "get-customer-labels",
    "search-customers-by-labels",
    "transaction",
    "add-transaction-with-local-currency",
    "update-transaction-details",
    "cancel-transaction-lineitem",
    "get_transaction_detailsv1",
    "return-transaction",
    "retro-transaction",
    "add-transaction-single",
    "addreturn-transaction-bulk",
    "update-transaction",
    "update-transaction-bulk",
    "get-transaction-details",
    "retrieve-transaction-details-with-bill-number",
    "simulate_transactionadd",
    "expose-evaluation-log-for-an-event",
    "transaction-status-codes",
    "getrejectedtransactions",
    "getretriggerstatus",
    "markfailed",
    "retriggertransactionadd",
    "coupon-1",
    "issue-coupon-1",
    "resend-coupon",
    "redeem-coupon",
    "get-coupon-detail",
    "get-customer-coupons",
    "is-coupon-redeemable",
    "get-coupon-series-details-1",
    "coupon",
    "create-coupon-series",
    "update-coupon-series",
    "get-coupon-series-details",
    "issue-single-coupon",
    "issue-bulk-coupons",
    "issue-bulk-coupon-with-count-from-series",
    "redeem-single-coupon",
    "redeem-bulk-coupons",
    "check-if-coupon-is-redeemable",
    "reactivate-redeemed-coupon",
    "get-coupon-details",
    "get-customer-coupons-basic",
    "update-coupon-redeem-field",
    "update-coupon-code-expiry-date",
    "revoke-coupon",
    "upload-coupons-batch",
    "upload-redeemed-coupons",
    "get-status-of-redeemed-coupons",
    "points-v2-api",
    "-customer-points-transferrable",
    "transfer-points-customer",
    "get-points-transfer-details",
    "reverse-redeemed-points",
    "group-points-transferrable",
    "transfer-group-points",
    "points-unlock-api",
    "update-redeem-points",
    "deduct-points-and-alternatecurrencies-from-user-using-userid",
    "check-if-points-redeemable",
    "issue-validation-code",
    "redeem-points",
    "points-ledger",
    "get-customer-ledger-balance",
    "get-ledger-information",
    "get-points-ledger-explode-info",
    "connectedorgs-get-customer-ledger-info",
    "connectedorgs-get-customer-ledger-explode-info",
    "cards",
    "generate-cards",
    "get-card-generation-log",
    "add-card-details-single",
    "update-card-details-single",
    "update-card-details-bulk",
    "get-card-details",
    "get-status-log",
    "limit-active-cards-per-customer",
    "add-card-number-to-a-card-series",
    "add-external-reference-id-to-card",
    "create-meta-search",
    "get-meta",
    "enable-bulk-trigger",
    "perform-search",
    "deactivate-search-criteria",
    "create-data-field",
    "put-data-field-api",
    "get-data-field-detail-api",
    "search-api-cortex-api",
    "badges",
    "create-badges-org",
    "fixed-window-use-case",
    "get-all-badges",
    "get-fixed-window-details",
    "claim-badge",
    "unclaim-badge",
    "update-the-activation-status-of-badge",
    "enrol-customers-for-badges",
    "import-earned-badges-of-customer",
    "revoke-enrolment-of-a-badge",
    "revoke-issual-of-a-badge",
    "get-badges-for-customer",
    "get-all-customer-badges",
    "create-badges-group",
    "update-badges-group",
    "get-group-by-id",
    "get-all-groups",
    "create-custom-field",
    "get-custom-field-by-id",
    "get-all-custom-fields",
    "create-reward-category",
    "update-reward-category",
    "get-reward-category",
    "adding-revenue-metadata-against-a-reward",
    "post-issue-user-reward",
    "reward-issuance-with-quantity-and-calculation-scenarios",
    "issue-bulk-reward",
    "get-rewards-for-user",
    "get-reward-list",
    "get-reward-details-by-id",
    "get-brands-rewards",
    "get-rewards-for-user-new-api",
    "get-user-brand-specific-rewards",
    "get-all-reward-transactions-for-a-user",
    "get-transaction-details-by-reward-transaction-id",
    "post-create-catalog-promotion",
    "get-catalog-promotion-details",
    "get-list-of-promotions",
    "put-disable-promotion",
    "get-available-brand-rewards",
    "post-create-custom-field",
    "update-custom-field",
    "get-custom-field",
    "create-group-reward",
    "update-group-reward",
    "get-group-rewards",
    "create-points-restriction",
    "update-points-restriction",
    "organisation-level-configuration-for-rewards-catalog",
    "retrieve-organisation-level-configuration-for-rewards-catalog",
    "createvendor",
    "create-vendor-redemption",
    "get-vendor-redemptions-details",
    "get-vendor-list-for-specific-brand",
    "post-images-to-file-service",
    "create-fulfillment-status",
    "get-fulfillment-status",
    "update-fulfilment-status-and-txn-custom-fields",
    "create-reward-expiry-reminder",
    "update-reward-expiry-reminder",
    "get-reward-expiry-reminder",
    "get-all-available-rewards-for-user-in-a-connected-org",
    "get-reward-details-by-id-in-a-connected-org",
    "issue-bulk-reward-connected-org",
    "get-purchased-rewards-for-user-connected-org",
    "get-all-reward-transactions-for-a-user-in-connected-orgs",
    "get-transaction-details-by-reward-transaction-id-in-connected-orgs",
    "get-user-rewards-merge-details",
    "create-target-groups",
    "update-target-group",
    "get-target-groups-id",
    "getusertargetgroupdetails",
    "get-active-targets",
    "get-target-groups-all",
    "get-target-periods",
    "get-targets",
    "get-target-communication-template",
    "get-target-upload-file",
    "get-target-channels",
    "delete-target-group",
    "create-target-period",
    "create-unified-targets",
    "update-unified-target",
    "create-streak",
    "edit-streaks",
    "create-target-group-based-on-behavioural-event",
    "create-target-based-on-emf-eventss",
    "create-target-based-on-alternate-currencies",
    "get-all-milestones",
    "enrol-customer-to-a-milestone",
    "un-enrol-users-into-a-milestonestreak",
    "check-validity-of-milestone-name",
    "get-target-events",
    "user-created-challenges",
    "connectedorgs-enroll-customer-milestone-or-streak",
    "connectedorgs-unenroll-customer-milestone-or-streak",
    "connectedorgs-get-associated-target-groups-of-a-user",
    "connected-orgs-data-scopes",
    "get-top-ranked-users",
    "get-user-ranks-across-target-groups",
    "promotion",
    "enrol-and-issue-promotion",
    "revoke-enrolled-and-issued-promotion",
    "connectedorgs-get-promotion-data",
    "create-promotion-for-ucc",
    "get-promotion-by-id",
    "get-promotion-details",
    "get-promotion-data",
    "loyalty-cart-promotions",
    "get-promotion-settings",
    "get-promotion-redemptions",
    "get-promotions-code-api",
    "get-promotions-for-a-particular-till",
    "get-lock-unlock-pending-carts",
    "get-promotions-config-api",
    "create-promotion-1",
    "set-promotion-settings",
    "deactivate-promotion",
    "activate-promotion",
    "post-revoke-earned-promotion",
    "post-earn-promotions-in-bulk",
    "post-evaluate-promotions",
    "post-cancel-cart-evaluation",
    "post-promotions-code-link-api",
    "get-promotions-for-a-customer",
    "issue-cart-promotion",
    "add-group",
    "update-user-group",
    "get-user-group-details",
    "delete-user-group",
    "join-member-to-group",
    "remove-group-member",
    "transfer-group-member",
    "get-group-transactions",
    "retrieve-user-group-member-details",
    "retrieve-user-group-members-list-with-cards-status-details",
    "retrieve-primary-secondary-member-details",
    "get-points-expiry-schedule-of-a-group",
    "retrieve-points-conversion-schedule",
    "user-group-status-codes",
    "update-user-group-permission",
    "search-for-groups-using-the-extended-fields",
    "organization",
    "get-org-details",
    "get-org-entities",
    "get-org-configurations",
    "get-org-statistics",
    "get-top-selling-items",
    "retrieve-brand-id",
    "get-org-payment-modes",
    "add-till-with-new-custom-fields",
    "update-till-with-custom-field-info",
    "get-org-custom-fields",
    "get-tills",
    "retrieve-org-hierarchy-details",
    "v2-send-communication-message",
    "communications",
    "send-communication-message",
    "error-code",
    "create-a-custom-field",
    "get-custom-fields",
    "tag-custom-field-to-an-entity",
    "get-entity-audit-logs",
    "get-audit-logs",
    "pii-deletion",
    "update-pii-deletion-status",
    "retrieve-pii-deletion-request-status",
    "retrieve-pii-deletion-request-details",
    "pii-deletion-error-codes",
    "leads",
    "add-lead-1",
    "update-lead-status",
    "update-lead-followups",
    "update-lead",
    "set-lead-reasons",
    "get-lead-follow-ups",
    "get-lead-reasons",
    "get-lead-details",
    "get-lead-substatus",
    "assign-lead",
    "search-lead",
    "add-staff-account",
    "edit-staff-details",
    "get-staff-details",
    "change-account-password",
    "send-otp",
    "validate-otp-1",
    "change-identifier-send-otp",
    "change-identifier-validate-otp",
    "transfer-staff-user",
    "get-staff-of-storezone",
    "logout-staff-account",
    "remove-staff-account",
    "create-event-custom-be",
    "update-event-custom",
    "get-org-all-events",
    "get-running-event-status",
    "add-webhook",
    "get-events-logs",
    "get-events-meta",
    "get-specific-event-data",
    "search-events",
    "post-event",
    "event-logs",
    "get-event-log-by-request-id-",
    "get-event-log-by-reference-id-",
    "get-event-log-by-event-id",
    "response-codes",
    "company-1",
    "add-company",
    "update-company",
    "get-company-details",
    "remove-company",
    "get-org-companies",
    "get-companies-by-extended-field-values",
    "add-request",
    "approve-requests",
    "reject-requests",
    "get-request-details",
    "get-request-log",
    "add-transaction-request",
    "update-transaction-request",
    "retrieve-transaction-request-status",
    "retrieve-transaction-request-details",
    "request-event-notification",
    "error-codes",
    "change-customer-status",
    "points-redemption",
    "issue-goodwill-points",
    "earn-badge-issue-badge-to-single-customercustomer-earns-the-badge",
    "issue-badge-enrol-customers-for-badges",
    "retro-transaction-claim-transaction",
    "approve-or-reject-a-request",
    "get-all-requests",
    "get-request-info",
    "error-codes-request-workflow",
    "partner-program",
    "link-customer-to-partner-program",
    "update-customer",
    "delink-customer",
    "get-customer-activity",
    "customeractivityhistories",
    "user-authentication",
    "register-users",
    "authorize-user",
    "update-password",
    "generate-otp",
    "otp-template-guidelines",
    "validate-otp",
    "get-otp",
    "success-and-error-codes",
    "add-product",
    "get-product-details",
    "search-products",
    "add-product-attributes",
    "get-product-attributes",
    "get-product-categories",
    "get-product-brands",
    "get-product-colors",
    "get-product-sizes",
    "get-product-meta-sizes",
    "response-codes-1",
    "store",
    "get-store-tasks",
    "verify-store-login-credentials",
    "upload-store-reports",
    "get-store-reports",
    "verify-login-credentials",
    "task",
    "add-tasks",
    "update-tasks",
    "get-tasks-metadata",
    "get-task-logs",
    "createupdate-task-reminders",
    "generate-authentication-tokenapi",
    "generate-otp-api",
    "validate-otp-api",
    "validate-password",
    "change-password",
    "forget-password",
    "status-codes",
    "multi-factor-authentication",
    "generate-mfa-token",
    "generate-otp-mfa",
    "validate-mfa-otp",
    "validate-mfa-password",
    "change-mfa-password",
    "mfa-forgot-password",
    "regenerate-token",
    "delete-token",
    "authentication-configurations",
    "refer-customer",
    "get-referrals",
    "validate-referral-code",
    "post-create-api-diy-template-connectplus",
    "get-workspaces-diy-connectplus-template",
    "get-processor-diy-connectplus-template",
    "get-transaction-earning",
    "trigger-walk-in-notifications-on-instore",
    "update-currency-ratio",
    "generate-card-external-id",
    "configure-org-extended-field",
    "get-org-extended-fields",
    "feed-scan-event",
    "get-configured-card-limit-per-customer",
    "get-org-sources",
    "retrieve-extended-field-config-details",
]

SDK_PAGES = [
    "overview_android-sdk",
    "configure-firebase",
    "set-up-source-account",
    "configure-gateway",
    "installing-sdk",
    "sdk-initialisation",
    "track-events",
    "push-notification",
    "in-app-messaging",
    "configure-notification-center",
    "xiaomi-push-notification",
    "overview_ios_sdk",
    "set-up-source-account-ios",
    "configure-gateway-ios",
    "install-sdk",
    "initialise-ios-sdk",
    "set-up-events-tracking",
    "configure-push-notifications",
    "in-app-messaging_ios",
    "configure-notification-center_ios",
    "setting-up-react-native-project-for-hydra-sdk",
    "push-notification-for-hydra-sdk",
    "n-app-messaging-for-hydra-sdk",
    "notification-center",
]


def scrape_page(page_slug):
    url = BASE_URL + page_slug
    try:
        response = requests.get(url)
        response.raise_for_status()
    except Exception as e:
        print(f"Error fetching {url}: {e}")
        return None

    soup = BeautifulSoup(response.text, "html.parser")

    title_tag = soup.find("h1")
    content_div = soup.find("div", class_="doc-content")

    title = title_tag.get_text(strip=True) if title_tag else "No Title Found"
    content = (
        content_div.get_text(separator="\n", strip=True)
        if content_div
        else soup.get_text(separator="\n", strip=True)
    )

    return {"url": url, "page_slug": page_slug, "title": title, "content": content}


def scrape_docs():
    docs = []
    for idx, page in enumerate(SDK_PAGES, start=1):
        print(f"[{idx}/{len(SDK_PAGES)}] Scraping: {page}")
        data = scrape_page(page)
        if data:
            docs.append(data)
        else:
            print(f"Failed to scrape {page}")
        time.sleep(1)

    with open("capillary_docs_data_6.json", "w", encoding="utf-8") as f:
        json.dump(docs, f, indent=2, ensure_ascii=False)
    print(f"\n✅ Scraping complete. Total pages scraped: {len(docs)}")


if __name__ == "__main__":
    scrape_docs()
